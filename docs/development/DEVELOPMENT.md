# 開發計劃文檔

**更新日期**: 2024年12月

## 📋 項目狀態

### 已完成 ✅

- ✅ 基礎項目結構（Tauri + React + TypeScript）
- ✅ PDF 查看器（拖放、連續滾動、縮放）
- ✅ 音頻錄製（Web Audio API、格式轉換）
- ✅ Whisper 轉錄（本地、實時、< 2 秒延遲）
- ✅ 字幕顯示（歷史列表、時間戳）
- ✅ **翻譯功能（本地 ONNX 模型）** - 2024年12月完成
  - ✅ ONNX Runtime 集成
  - ✅ opus-mt-en-zh 模型集成
  - ✅ 問題修復（空輸出、重複問題）
  - ✅ 測試驗證通過
- ✅ **數據存儲（SQLite）** - 2024年12月完成
  - ✅ SQLite 數據庫集成（rusqlite）
  - ✅ 數據模型定義（Lecture, Subtitle, Note, Setting）
  - ✅ CRUD 操作實現
  - ✅ Tauri Commands 接口
  - ✅ 前端服務封裝（storageService.ts）
  - ✅ 設置功能完善
  - ✅ 測試驗證通過（11個測試全部通過）

### 進行中 🚧

- 🚧 音頻設備管理
- 🚧 前端 UI 細節優化

### 待實現 ⏳

- ⏳ 遠程服務端集成（可選）
- ⏳ AI 助教功能（可選）
- ⏳ 筆記生成功能（可選）

## 🎯 MVP 範圍

### 核心功能（必須實現）

1. **PDF 查看器** ✅
2. **音頻錄製** ✅
3. **本地 ASR 服務** ✅
4. **字幕顯示** ✅
5. **翻譯功能** ✅（本地 ONNX 模型）
6. **數據存儲** ✅（SQLite）
7. **設置功能** ✅（數據庫持久化）

### 可選功能（後續實現）

- ⏸️ 遠程服務端 ASR（精字幕）
- ⏸️ AI 助教對話
- ⏸️ 課後筆記生成
- ⏸️ 筆記導出（Markdown/PDF）

## 📅 開發階段

### 階段一：核心功能（已完成）
- PDF 查看器
- 音頻錄製
- Whisper 轉錄
- 字幕顯示

### 階段二：翻譯功能（已完成）✅
- ✅ 粗翻譯（本地 ONNX 模型）
  - ✅ opus-mt-en-zh 模型集成
  - ✅ ONNX Runtime 集成
  - ✅ Tokenizer 集成
  - ✅ Encoder-Decoder 架構實現
  - ✅ 自回歸生成邏輯
  - ✅ 問題修復（空輸出、重複問題）
  - ✅ 測試驗證通過（75% 成功率）
- ✅ 精翻譯接口（遠程，可選，已預留）
- ✅ 雙語字幕顯示

### 階段三：數據存儲（已完成）✅
- ✅ SQLite 數據庫集成
- ✅ 課程數據存儲
- ✅ 字幕數據持久化
- ✅ 筆記數據存儲
- ✅ 設置數據持久化
- ✅ 前端服務封裝
- ✅ 測試驗證通過

### 階段四：增強功能（待開始）
- 音頻設備管理
- 設置功能完善
- 錯誤處理優化

## 🔧 技術棧

- **前端**：React + TypeScript + Tailwind CSS
- **後端**：Rust + Tauri
- **ASR**：whisper-rs
- **翻譯**：ONNX Runtime (`ort`) + opus-mt-en-zh（本地）+ HTTP API（遠程，可選）
- **數據庫**：SQLite（rusqlite，待集成）

## 📊 當前進度

### MVP 核心功能完成度：約 95%

| 功能模塊 | 狀態 | 完成度 |
|---------|------|--------|
| PDF 查看器 | ✅ | 100% |
| 音頻錄製 | ✅ | 100% |
| Whisper 轉錄 | ✅ | 100% |
| 字幕顯示 | ✅ | 100% |
| 翻譯功能 | ✅ | 95% |
| 數據存儲 | ✅ | 100% |
| 設置功能 | ✅ | 100% |

### 翻譯功能詳細狀態

**粗翻譯（本地 ONNX 模型）**:
- ✅ 模型集成完成
- ✅ 問題修復完成（空輸出 0%，重複 0%）
- ✅ 測試驗證通過（75% 成功率）
- ✅ 可穩定使用

**精翻譯（遠程 API）**:
- ✅ 接口預留完成
- ⏳ 實際服務端待實現（可選）

## 🚀 下一步計劃

### 短期（1-2 週）

1. **前端 UI 完善**
   - 細節優化和美化
   - 響應式設計完善

2. **設置功能增強**
   - 模型路徑配置
   - 翻譯策略配置
   - 數據導出/導入功能

### 中期（2-4 週）

1. **音頻設備管理**
   - 設備列表獲取
   - 設備選擇功能

2. **性能優化**
   - 翻譯緩存
   - 批量處理

3. **測試和文檔**
   - 單元測試
   - 集成測試
   - 用戶文檔

## 📝 開發規範

1. **代碼風格**：遵循 Rust 和 TypeScript 標準
2. **錯誤處理**：完善的錯誤處理和日誌
3. **性能目標**：轉錄延遲 < 2 秒，翻譯延遲 < 200ms
4. **用戶體驗**：本地優先，離線可用

## 📚 相關文檔

- `../translation/TRANSLATION.md` - 翻譯功能總覽
- `../translation/TRANSLATION_STATUS.md` - 翻譯功能狀態
- `../translation/OPUS_MT_BEST_PRACTICES.md` - 翻譯最佳實踐
- `../whisper/WHISPER_TRANSCRIPTION.md` - Whisper 轉錄功能
- `../storage/STORAGE.md` - 數據存儲功能文檔
- `../models/MODEL_CONVERSION_GUIDE.md` - 模型轉換指南

